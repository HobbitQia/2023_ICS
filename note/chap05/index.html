<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="HobbitQia" name="author"/>
<link href="https://hobbitqia.github.io/2023_ICS/note/chap05/" rel="canonical"/>
<link href="../chap04/" rel="prev"/>
<link href="../chap06/" rel="next"/>
<link href="../../favicon.ico" rel="icon"/>
<meta content="mkdocs-1.4.3, mkdocs-material-9.1.18" name="generator"/>
<title>LC-3 - 2023_ICS</title>
<link href="../../assets/stylesheets/main.26e3688c.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.ecc896b0.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"LXGW WenKai Screen";--md-code-font:"JetBrains Mono"}</style>
<link href="../../css/heti.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="../../css/custom.css" rel="stylesheet"/>
<link href="../../css/card.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="brown" data-md-color-primary="brown" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#the-lc-3">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="2023_ICS" class="md-header__button md-logo" data-md-component="logo" href="../.." title="2023_ICS">
<img alt="logo" src="../../favicon.ico"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            2023_ICS
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              LC-3
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="brown" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="brown" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="brown" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/HobbitQia/2023_ICS" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    2023_ICS
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="标签" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        Home
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../">
        Lecture Notes
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../lab/">
        Labs
      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="2023_ICS" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="2023_ICS">
<img alt="logo" src="../../favicon.ico"/>
</a>
    2023_ICS
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/HobbitQia/2023_ICS" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    2023_ICS
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../..">Home</a>
<label for="__nav_1">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          Home
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../resource/">
        Resource
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../schedule/">
        Schedule
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../syllabus/">
        Syllabus
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/">
        FAQ
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">Lecture Notes</a>
<label for="__nav_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Lecture Notes
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../chap01/">
        Welcome Abroad
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../chap02/">
        Bits, Data Types and Operations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../chap03/">
        Digital Logic Structures
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../chap04/">
        The von Neumann Model
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          LC-3
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        LC-3
      </a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-isa-overview">
    The ISA: Overview
  </a>
<nav aria-label="The ISA: Overview" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#memory-organization">
    Memory Organization
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#registers">
    Registers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-instruction-set">
    The Instruction Set
  </a>
<nav aria-label="The Instruction Set" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#opcodes">
    Opcodes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-types">
    Data Types
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#addressing-modes">
    Addressing Modes
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-instruction-set-of-the-lc-3">
    The Instruction Set of the LC-3
  </a>
<nav aria-label="The Instruction Set of the LC-3" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#operate-instructions">
    Operate Instructions
  </a>
<nav aria-label="Operate Instructions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#not">
    NOT
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#immdiates-in-operate-instructions">
    Immdiates In Operate Instructions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-lea-instruction">
    The LEA Instruction
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-movement-instructions">
    Data Movement Instructions
  </a>
<nav aria-label="Data Movement Instructions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pc-relative-mode">
    PC-Relative Mode
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#indirect-mode">
    Indirect Mode
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#baseoffset-mode">
    Base+offset Mode
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#control-instructions">
    Control Instructions
  </a>
<nav aria-label="Control Instructions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#conditional-branches">
    Conditional Branches
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-jmp-instruction">
    The JMP Instruction
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-trap-instruction">
    The TRAP Instruction
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-datapath">
    The Datapath
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../chap06/">
        Programming
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../chap07/">
        Assembly Language
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../chap08/">
        Data Structures
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../chap09/">
        I/0
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../lab/">Labs</a>
<label for="__nav_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Labs
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../lab/lab1/">
        Lab1
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../lab/lab2/">
        Lab2
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../lab/lab3/">
        Lab3
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../lab/lab4/">
        Lab4
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../lab/lab5/">
        Lab5
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../lab/lab6/">
        Lab6
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-isa-overview">
    The ISA: Overview
  </a>
<nav aria-label="The ISA: Overview" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#memory-organization">
    Memory Organization
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#registers">
    Registers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-instruction-set">
    The Instruction Set
  </a>
<nav aria-label="The Instruction Set" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#opcodes">
    Opcodes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-types">
    Data Types
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#addressing-modes">
    Addressing Modes
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-instruction-set-of-the-lc-3">
    The Instruction Set of the LC-3
  </a>
<nav aria-label="The Instruction Set of the LC-3" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#operate-instructions">
    Operate Instructions
  </a>
<nav aria-label="Operate Instructions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#not">
    NOT
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#immdiates-in-operate-instructions">
    Immdiates In Operate Instructions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-lea-instruction">
    The LEA Instruction
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-movement-instructions">
    Data Movement Instructions
  </a>
<nav aria-label="Data Movement Instructions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pc-relative-mode">
    PC-Relative Mode
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#indirect-mode">
    Indirect Mode
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#baseoffset-mode">
    Base+offset Mode
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#control-instructions">
    Control Instructions
  </a>
<nav aria-label="Control Instructions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#conditional-branches">
    Conditional Branches
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-jmp-instruction">
    The JMP Instruction
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-trap-instruction">
    The TRAP Instruction
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-datapath">
    The Datapath
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="the-lc-3">The LC-3<a class="headerlink" href="#the-lc-3" title="Permanent link">¶</a></h1>
<div class="card file-block">
<div class="file-icon"><img src="../../assets/pdf.svg" style="height: 3em;"/></div>
<div class="file-body">
<div class="file-title">Chapter 5</div>
<div class="file-meta">1074 KB / 10 P / 2023-07-16</div>
</div>
<p><a class="down-button" href="../../assets/notes/chap05.pdf" markdown="1" target="_blank"><span class="twemoji"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"></path></svg></span> 下载</a></p>
</div>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<ul>
<li>The ISA of LC-3<ul>
<li>Memory Organization</li>
<li>Registers</li>
<li>Instruction Set<ul>
<li>Operate</li>
<li>Data Movement</li>
<li>Control</li>
</ul>
</li>
</ul>
</li>
<li>Microarchitecture of LC-3. (Datapath)</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It's worth noting that in the notes I skip many examples on the book. However, if you have not taken the course <em>Assembly Language</em>, or not familiar with programming in assembly language, please read the example on the textbook carefully and practice it sufficiently. </p>
</div>
<h2 id="the-isa-overview">The ISA: Overview<a class="headerlink" href="#the-isa-overview" title="Permanent link">¶</a></h2>
<p>The ISA specifies the <em>memory organization, register set and instruction set</em>, including the opcodes, data types, addressing modes of the instruction in the instruction set.</p>
<h3 id="memory-organization">Memory Organization<a class="headerlink" href="#memory-organization" title="Permanent link">¶</a></h3>
<ul>
<li><strong>address space</strong>: <span class="arithmatex">\(2^{16}\)</span> (<strong>i.e.</strong> 65536) locations.<br/>
Not all 65536 addresses are actually used for memory locations.</li>
<li><strong>addressability</strong>: 16 bits. We refer to 16 bits as 1 <strong>word</strong> in the LC-3, so it's also called <strong>word-addressable</strong>.</li>
</ul>
<h3 id="registers">Registers<a class="headerlink" href="#registers" title="Permanent link">¶</a></h3>
<p>As mentioned before, each register is called a <strong>GPR (General Purpose Register)</strong>. They are referred to as <span class="arithmatex">\(R0, R1, \ldots R7\)</span>.  </p>
<p>Registers store information that can be operated on later, and they are stored register files, where CPU can access them faster than memory.</p>
<h3 id="the-instruction-set">The Instruction Set<a class="headerlink" href="#the-instruction-set" title="Permanent link">¶</a></h3>
<p>An instruction is made up of its opcode and operands.<br/>
The instruction set is defined by its set of opcdeos, data types and addressing modes.</p>
<h4 id="opcodes">Opcodes<a class="headerlink" href="#opcodes" title="Permanent link">¶</a></h4>
<p>The LC-3 ISA has 15 instructions and the opcode is specified in <code>bit[15:12]</code>. The code 1101 has been left unspecified. </p>
<h4 id="data-types">Data Types<a class="headerlink" href="#data-types" title="Permanent link">¶</a></h4>
<p>Every opcode will interpret the bit patterns of its operands according to the data type it's designed to support.  </p>
<p>The same bit pattern can correspound to different number, depending on instructions that interpret it. <strong><em>e.g.</em></strong> <code>ADD R2, R1, #1</code>, <code>LD R2, #1</code>. In ADD, <code>#1</code> is interpreted as a number for arithmetic, while in LD, <code>#1</code> is interpreted as an address.  </p>
<h4 id="addressing-modes">Addressing Modes<a class="headerlink" href="#addressing-modes" title="Permanent link">¶</a></h4>
<p>An operand can generally be found in one of 3 places: <em>in memory, in a register or as a part of the instruction</em>. If the operand of the instruction, we refer to it as a <strong>literal</strong> or as an <strong>immediate</strong> operand.  </p>
<p>The LC-3 supports 5 addressing modes: <em>immediate</em> (or literal), <em>register</em> and 3 memory addressing modes: <em>PC-relative</em>, <em>indirect</em> and <em>Base+offset</em>.</p>
<h2 id="the-instruction-set-of-the-lc-3">The Instruction Set of the LC-3<a class="headerlink" href="#the-instruction-set-of-the-lc-3" title="Permanent link">¶</a></h2>
<h3 id="operate-instructions">Operate Instructions<a class="headerlink" href="#operate-instructions" title="Permanent link">¶</a></h3>
<h4 id="not">NOT<a class="headerlink" href="#not" title="Permanent link">¶</a></h4>
<p><img src="https://s2.loli.net/2022/07/15/54yhRGj6VbHwOvD.png" width="100%"/></p>
<p>The <strong>NOT</strong> (opcode=1001) instruction is the only operate instruction that performs a <em>unary</em> operation. <code>bits[11:9]</code> is DR, <code>bits[8:6]</code> is SR, and <code>bits[5:0]</code> are set to 1.  </p>
<p>The datapath of NOT is as follows:
<img src="https://s2.loli.net/2022/07/15/ZRd3L1BPJUmOAcW.png" width="70%"/></p>
<p>For binary operations (like ADD, AND) the datapath is almost the same except the operand B which is also from the register files.</p>
<h4 id="immdiates-in-operate-instructions">Immdiates In Operate Instructions<a class="headerlink" href="#immdiates-in-operate-instructions" title="Permanent link">¶</a></h4>
<p>The diagram below shows <code>ADD R1, R4, #-2</code>. Note that we the operand B is computed by <em>signed-extending</em> <code>bits[4:0]</code> to 16 bits. And since there is only 5 bits to store immediates, not all 2's complement intergers can be immediate operands. (only <span class="arithmatex">\([-16, 15]\)</span>)
<img src="https://s2.loli.net/2022/07/15/Rlp9Z64FTXKdaUL.png" width="70%"/></p>
<p>With the help of NOT and ADD (with immediate), we can implement the <em>substraction</em>. (Recall that in Chapter 2, the negative of an integer represented in 2's complement can be obtained by complementing the number and adding 1)  </p>
<h4 id="the-lea-instruction">The LEA Instruction<a class="headerlink" href="#the-lea-instruction" title="Permanent link">¶</a></h4>
<p><strong>LEA</strong> (opcode=1110) loads the register specified by <code>bits[11:9]</code> of the instruction with the value formed by adding the incremented PC to the <em>sign-extended</em> <code>bits[8:0]</code> of the instruction.</p>
<p>LEA is useful to <em>initiallize a register with an address</em>.</p>
<p>Note that the values to be loaded into the register <em>does not involve any access to memory</em>, and it does not affect CC.</p>
<p><img src="https://s2.loli.net/2022/07/15/OBi49TSUtN23ZqR.png" width="70%"/></p>
<h3 id="data-movement-instructions">Data Movement Instructions<a class="headerlink" href="#data-movement-instructions" title="Permanent link">¶</a></h3>
<p>The process of moving information from memory to a register is caled <strong>load</strong>, and the process of moving information from a register to a memory is called <strong>store</strong>. </p>
<p>The LC-3 contains 6 instructions that move formation:　LD, LDR, LDI, ST, STR, STI. The format: 
<img src="https://s2.loli.net/2022/07/15/oT5GsSKh4etpmzk.png" width="100%"/></p>
<ul>
<li>
<p><strong>PC-Relative Mode</strong>: <strong>LD</strong> and <strong>ST</strong>
<img src="https://s2.loli.net/2022/07/15/Alrnkiu3ypvbZPK.png" width="100%"/></p>
</li>
<li>
<p><strong>Indirect Mode</strong>: <strong>LDI</strong> and <strong>STI</strong>
<img src="https://s2.loli.net/2022/07/15/JcZ6bdiqK1l5Uw2.png" width="100%"/></p>
</li>
<li>
<p><strong>Base+offset Mode</strong>: <strong>LDR</strong> and <strong>STR</strong>
<img src="https://s2.loli.net/2022/07/15/Dx3ThbQ4Gsz6HrZ.png" width="100%"/></p>
</li>
</ul>
<p>Note that laod instructions will influence CC, while store not. The value that is finally read from memory and will be loaded to the register determine CC.</p>
<p>It's also worth noting that if some bits specify DR in load instructions, then it will specify SR in store instructions.</p>
<h4 id="pc-relative-mode">PC-Relative Mode<a class="headerlink" href="#pc-relative-mode" title="Permanent link">¶</a></h4>
<p><strong>LD</strong> (opcode=0010) and <strong>ST</strong> (opcode=0011) specify the <strong>PC-relative</strong> addressing mode. </p>
<p>The memory address is computed by <em>signed-extending</em> <code>bits[8:0]</code> to 16 bits and adding the result to the <em>incremented PC</em> (incremented during FETCH phase). </p>
<p>Note that the address of the memory opearand is limited to a small range. (<span class="arithmatex">\([-255,+256]\)</span>)</p>
<p><img src="https://s2.loli.net/2022/07/15/fKwEXeVDpJoj2TF.png" width="70%"/></p>
<h4 id="indirect-mode">Indirect Mode<a class="headerlink" href="#indirect-mode" title="Permanent link">¶</a></h4>
<p><strong>LDI</strong> (opcode=1010) and <strong>STI</strong>(opcode=1011) specify the <strong>indirect</strong> addressing mode.  </p>
<p>An address is first formed exactly the same way as with LD, however, the result is the address of the address of the operand. So we need to interrogate memory twice. </p>
<p>Note that the address of the operand can be <em>anywhere</em>.</p>
<p><img src="https://s2.loli.net/2022/07/15/PvYQFLBEoKfu79G.png" width="70%"/></p>
<p>In the example above, the incremented PC is <code>x4A1C</code> and the sign-extended offset is <code>xFFCC</code>. So we first get the address <code>x49E8</code> and get the data in <code>x49E8</code>, which is <code>x2110</code>. Then we obtain the data in <code>x2110</code> and load the value into the register <code>R3</code>. </p>
<h4 id="baseoffset-mode">Base+offset Mode<a class="headerlink" href="#baseoffset-mode" title="Permanent link">¶</a></h4>
<p><strong>LDR</strong> (opcode=0110) and <strong>STR</strong> (opcode=0111) specify the <strong>Base+offset</strong> addressing mode.</p>
<p>The address is obtained by adding a <em>signed-extended</em> 6-bit(<code>bits[5:0]</code>) offset to a base register(<code>bits[8:6]</code>). </p>
<p>Note that the address of the operand can also be <em>anywhere</em>.</p>
<p><img src="https://s2.loli.net/2022/07/15/kZcDdNHxw72SmFo.png" width="70%"/></p>
<h3 id="control-instructions">Control Instructions<a class="headerlink" href="#control-instructions" title="Permanent link">¶</a></h3>
<p>The LC-3 has 5 opcodes that enable the sequential execution flow to be broken: <em>conditional branch</em>, <em>unconditional jump</em>, <em>subroutine call</em>( funtion), <em>TRAP</em> (service call) and <em>RTI</em>.</p>
<h4 id="conditional-branches">Conditional Branches<a class="headerlink" href="#conditional-branches" title="Permanent link">¶</a></h4>
<p><img src="https://s2.loli.net/2022/07/15/tFYwsjUrcJBmx2k.png" width="100%"/></p>
<p><strong>BR</strong> (opcode=0000) uses condition codes to determine whether or not to depart from the usual sequential execution. Besides, not all condition codes will be inpected and we can determine which condition codes will be inspected. <strong><em>e.g.</em></strong> In <code>BRz x0D9</code>, <code>bit[11:9]=010</code> so we only check the condition code Z, which means if the result of the last instruction that can set CC is zero, then we will jump to the target address. </p>
<p>Additionally, if we request to check all condition codes, like <code>BRnzp x0D9</code>, it means an <strong>unconditional branch</strong>.  Since the result of the operation can be positive, negative or zero, so at least one of CC will be set. Meanwhile, if <code>bits[11:9]=000</code>, nothing will happen, just like a nop (an insruction but do nothing and will cause no difference)</p>
<p>In summary, it is only <em>ADD, AND, LD, LDI, LDR, NOT</em> that will change CC after finishing operations.</p>
<h4 id="the-jmp-instruction">The JMP Instruction<a class="headerlink" href="#the-jmp-instruction" title="Permanent link">¶</a></h4>
<p><img src="https://s2.loli.net/2022/07/15/TB8A7xo2iEmFWQw.png" width="100%"/></p>
<p>The <strong>JMP</strong> instruction (opcode=1100) loads the PC with the contents of the <em>register</em> specified by bits[8:6] of the instruction. (its addressing mode is by register)</p>
<h4 id="the-trap-instruction">The TRAP Instruction<a class="headerlink" href="#the-trap-instruction" title="Permanent link">¶</a></h4>
<p><img src="https://s2.loli.net/2022/07/15/8P7j5rg9o6n1d2K.png" width="100%"/></p>
<p>The <strong>TRAP</strong> instruction (opcode=1111) changes the PC to a memory address that is part of the operating system so that the OS will perform some task on behalf of the program. Once the service call ends, the PC is set to be the address of the instruction following the TRAP instruction.</p>
<ul>
<li>Input a character from the keyboard (<code>trapvector = x23</code>)</li>
<li>Output a character to the monitor (<code>trapvector = x21</code>)</li>
<li>Halt the program (<code>trapvector = x25</code>)</li>
</ul>
<p>Some useful trap service routines are given in the P675 Table A.3. The details of the TRAP instructions will be dicussed in Chapter 9.</p>
<h2 id="the-datapath">The Datapath<a class="headerlink" href="#the-datapath" title="Permanent link">¶</a></h2>
<p>Here is only a figure of LC-3 datapath. Please be clear of the data flow for each instruction and the related control signals. A good way is to draw a datapath on your own hands.  </p>
<p><img src="https://s2.loli.net/2022/07/15/B3RpuTriUJO1LQG.png" width="100%"/></p>
<hr/>
<div class="md-source-file">
<small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2023年7月17日 12:04:02</span>
<br/>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2023年7月5日 20:07:44</span>
</small>
</div>
<link href="/css/counter.css" rel="stylesheet"/>
<!-- Giscus -->
<h2 id="__comments">评论</h2>
<!-- 这里改成你的Giscus代码 -->
<script async="" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOJ2tLOM4CXysG" data-emit-metadata="0" data-input-position="bottom" data-lang="zh-CN" data-mapping="pathname" data-reactions-enabled="1" data-repo="HobbitQia/2023_ICS" data-repo-id="R_kgDOJ2tLOA" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js">
</script>
<!-- Reload on palette change -->
<script>
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object")
        if (palette.color.scheme === "slate") {
            var giscus = document.querySelector("script[src*=giscus]")
            giscus.setAttribute("data-theme", "dark")
        }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate" ? "dark" : "light"

                /* Instruct Giscus to change theme */
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    { giscus: { setConfig: { theme } } },
                    "https://giscus.app"
                )
            }
        })
    })
</script>
</article>
</div>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            回到页面顶部
          </button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
<script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
<script src="https://gcore.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
<script src="../../js/katex.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>